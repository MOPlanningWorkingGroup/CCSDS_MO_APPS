<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:util="http://www.springframework.org/schema/util" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:tx="http://www.springframework.org/schema/tx" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:jpa="http://osgi.org/xmlns/jpa/v1.1.0"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

	<import resource="classpath*:/jpaAutomationContext.xml" />
	
	<context:component-scan base-package="org.ccsds.moims.mo.mal.automation.service" />

	<bean id="procedureExecutionService"
		class="org.ccsds.moims.mo.mal.automation.service.ProcedureExecutionServiceImpl">
	</bean>

	<bean id="procedureExecutionServiceProvider"
		class="org.ccsds.moims.mo.mal.automation.provider.ProcedureExecutionServiceProvider"
		init-method="start" destroy-method="stop">
		<constructor-arg index="0" ref="procedureExecutionService" />
		<property name="propertyFile" value="/demoProvider.properties" />
	</bean>

	<bean id="procedureExecutionServiceConsumer"
		class="org.ccsds.moims.mo.mal.automation.consumer.ProcedureExecutionServiceConsumer"
		init-method="start" destroy-method="stop" depends-on="procedureExecutionServiceProvider">
		<constructor-arg index="0" value="SUB" />
		<property name="propertyFile" value="/demoConsumer.properties" />
		<property name="broker" value="#{procedureExecutionServiceProvider.brokerUri}" />
		<property name="uri" value="#{procedureExecutionServiceProvider.uri}" />
	</bean>

	<bean id="procedureExecutionServiceConsumer2"
		class="org.ccsds.moims.mo.mal.automation.consumer.ProcedureExecutionServiceConsumer"
		init-method="start" destroy-method="stop" depends-on="procedureExecutionServiceProvider">
		<constructor-arg index="0" value="SUBLISTENER" />
		<property name="propertyFile" value="/demoConsumer.properties" />
		<property name="broker" value="#{procedureExecutionServiceProvider.brokerUri}" />
		<property name="uri" value="#{procedureExecutionServiceProvider.uri}" />
	</bean>

	<bean id="scheduleExecutionService" class="org.ccsds.moims.mo.mal.automation.service.ScheduleExecutionServiceImpl">
	</bean>

	<bean id="scheduleExecutionServiceProvider"
		class="org.ccsds.moims.mo.mal.automation.provider.ScheduleExecutionServiceProvider"
		init-method="start" destroy-method="stop">
		<constructor-arg index="0" ref="scheduleExecutionService" />
		<property name="propertyFile" value="/demoProvider.properties" />
	</bean>

	<bean id="scheduleExecutionServiceConsumer"
		class="org.ccsds.moims.mo.mal.automation.consumer.ScheduleExecutionServiceConsumer"
		init-method="start" destroy-method="stop" depends-on="scheduleExecutionServiceProvider">
		<constructor-arg index="0" value="TASK_SUB" />
		<property name="propertyFile" value="/demoConsumer.properties" />
		<property name="broker" value="#{scheduleExecutionServiceProvider.brokerUri}" />
		<property name="uri" value="#{scheduleExecutionServiceProvider.uri}" />
	</bean>

</beans>
